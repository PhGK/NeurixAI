#geom_point(aes(color=molecular_names), size=3)+
geom_point(data = high_relevantometer_data, size=3, alpha = 1.0) +
geom_point(data = low_relevantometer_data, size=3, alpha = 0.3) +
geom_text_repel(data = high_relevantometer_data, aes(y = DRUG, x = pos, label = molecular_names),direction = 'y', color = 'black') +
geom_text_repel(data = low_relevantometer_data, aes(y = DRUG, x = pos, label = molecular_names),direction = 'y', color = 'black', alpha= 0.5) +
theme_minimal() +
theme(#panel.grid.major.y = element_blank(),
panel.grid.minor = element_blank(),
axis.title = element_blank(),
axis.text.y = element_text(size=15),
axis.text.x = element_text(size=15),
legend.title = element_blank(),
legend.text = element_text(size=15)) +
#ylab('Low importance rank     \U2194     High importance rank')  +
scale_y_discrete(limits=rev) +
scale_x_continuous(labels=scales::percent, limits=c(0.0,1.0)) +
coord_cartesian(xlim =c(0.0,1.0))
relevantometer
relevantometer <- ggplot(relevantometer_data, aes(y = DRUG, x = pos, label = molecular_names)) +
geom_line(data = line_data, aes(y = DRUG, x= x, color=moa), linewidth=1) +
#geom_point(aes(color=molecular_names), size=3)+
geom_point(data = high_relevantometer_data, size=3, alpha = 1.0) +
geom_point(data = low_relevantometer_data, size=3, alpha = 0.3) +
geom_text_repel(data = high_relevantometer_data, aes(y = DRUG, x = pos, label = molecular_names),direction = 'y', color = 'black') +
geom_text_repel(data = low_relevantometer_data, aes(y = DRUG, x = pos, label = molecular_names),direction = 'y', color = 'black', alpha= 0.3) +
theme_minimal() +
theme(#panel.grid.major.y = element_blank(),
panel.grid.minor = element_blank(),
axis.title = element_blank(),
axis.text.y = element_text(size=15),
axis.text.x = element_text(size=15),
legend.title = element_blank(),
legend.text = element_text(size=15)) +
#ylab('Low importance rank     \U2194     High importance rank')  +
scale_y_discrete(limits=rev) +
scale_x_continuous(labels=scales::percent, limits=c(0.0,1.0)) +
coord_cartesian(xlim =c(0.0,1.0))
relevantometer
sel_genes <-  c('ERBB2', 'EGFR', 'MDM2', 'TP53', 'MAP2K1','MAP2K6', 'MAP3K21')
rel_gene_names <- across_cell_lines %>%
filter(molecular_names %in% sel_genes)
#############################################
#find Cobimetinib import features
cob <- across_cell_lines %>% filter(grepl('MAP',molecular_names), DRUG == 'COBIMETINIB')
#############################################
#moa data
MOA <- fread('../data/secondary-screen-dose-response-curve-parameters.csv') %>%
select(name, moa, target) %>%
unique() %>%
mutate(DRUG = toupper(name), unique_moa = str_split_fixed(moa, ',', 2)[,1]==moa) %>%
mutate(moa = ifelse(DRUG=='DASATINIB', 'Bcr-Abl and Src kinase inhibitor', moa))
relevantometer_data <- across_cell_lines %>% filter(molecular_names %in% sel_genes) %>%
left_join(MOA)
order_by_moa <- relevantometer_data %>%
select(moa, DRUG) %>%
unique() %>%
dplyr::arrange(moa)
relevantometer_data <- relevantometer_data %>%
mutate(DRUG = factor(DRUG, levels = order_by_moa$DRUG))
across_cell_lines$molecular_names %>% unique() %>% length()
high_relevantometer_data <- relevantometer_data %>% filter(pos > 0.9)
low_relevantometer_data <- relevantometer_data %>% filter(pos <= 0.9)
#################for manuscript##################################################
read_percent_rank <- relevantometer_data %>% filter(molecular_names == 'MAP3K21')
line_data <- relevantometer_data %>% cross_join(data.frame(x=c(0,1)))
relevantometer <- ggplot(relevantometer_data, aes(x = DRUG, y = pos, label = molecular_names)) +
geom_line(data = line_data, aes(x = DRUG, y= x, color=moa), linewidth=2) +
#geom_point(aes(color=molecular_names), size=3)+
geom_point(size=3) +
geom_text_repel(aes(x = DRUG, y = pos, label = molecular_names),direction = 'y') +
#ylim(c(90,100)) +
#coord_cartesian(ylim=c(0.9,1.0)) +
coord_flip() +
theme_minimal() +
theme(panel.grid.major.y = element_blank(),
panel.grid.minor = element_blank(),
axis.title = element_blank(),
axis.text.y = element_text(size=15),
axis.text.x = element_text(size=15),
legend.title = element_blank(),
legend.text = element_text(size=15)) +
#ylab('Low importance rank     \U2194     High importance rank')  +
scale_x_discrete(limits=rev) +
scale_y_continuous(labels=scales::percent, limits=c(0.0,1.0))
relevantometer <- ggplot(relevantometer_data, aes(y = DRUG, x = pos, label = molecular_names)) +
geom_line(data = line_data, aes(y = DRUG, x= x, color=moa), linewidth=1) +
#geom_point(aes(color=molecular_names), size=3)+
geom_point(data = high_relevantometer_data, size=3, alpha = 1.0) +
geom_point(data = low_relevantometer_data, size=3, alpha = 0.3) +
geom_text_repel(data = high_relevantometer_data, aes(y = DRUG, x = pos, label = molecular_names),direction = 'y', color = 'black') +
geom_text_repel(data = low_relevantometer_data, aes(y = DRUG, x = pos, label = molecular_names),direction = 'y', color = 'black', alpha= 0.3) +
theme_minimal() +
theme(#panel.grid.major.y = element_blank(),
panel.grid.minor = element_blank(),
axis.title = element_blank(),
axis.text.y = element_text(size=15),
axis.text.x = element_text(size=15),
legend.title = element_blank(),
legend.text = element_text(size=15)) +
#ylab('Low importance rank     \U2194     High importance rank')  +
scale_y_discrete(limits=rev) +
scale_x_continuous(labels=scales::percent, limits=c(0.0,1.0)) +
coord_cartesian(xlim =c(0.0,1.0))
relevantometer
relevantometer
get_nth <- function(x, n=NULL) {
x <- x[order(x, decreasing=T)]
return(x[n])
}
most_important <- across_cell_lines %>%
group_by(DRUG) %>%
dplyr::mutate(cutoff = get_nth(meanabsLRP,30), scaled_LRP = meanabsLRP/max(meanabsLRP)) %>%
filter(meanabsLRP>=cutoff) %>%
mutate(rel = molecular_names %in% sel_genes) %>%
mutate(DRUG = factor(DRUG, levels = order_by_moa$DRUG))
most_important_only_red <- most_important %>%
filter(molecular_names %in% sel_genes)
most_important_without_red <- most_important %>%
filter(!(molecular_names %in% sel_genes))
most_important_genes_plot_rank <- ggplot(most_important, aes(x = DRUG, y = scaled_LRP, label = molecular_names)) +
geom_text_repel(data = most_important_without_red, show.legend=F, size=4, color='black', max.overlaps=100) +
geom_text_repel(data = most_important_only_red, show.legend=F, size=4, color='red', max.overlaps = 1000) +
geom_point(data=most_important_without_red, aes(x = DRUG, y = scaled_LRP),color='black') +
geom_point(data=most_important_only_red, aes(x = DRUG, y = scaled_LRP),color='red') +
#geom_line(aes(x = DRUG, y = rankl, group = molecular_names), linewidth=0.1) +
theme_minimal() +
scale_y_continuous(trans='log10') +
theme(axis.text = element_text(size=15),
axis.title.x = element_blank(),
axis.title.y = element_text(size=20)) +
ylab('xAI-assigned Importance')
most_important_genes_plot_rank
most_important_genes_plot_rank <- ggplot(most_important, aes(x = DRUG, y = scaled_LRP, label = molecular_names)) +
geom_text_repel(data = most_important_without_red, show.legend=F, size=4, color='black', max.overlaps=100) +
geom_text_repel(data = most_important_only_red, show.legend=F, size=4, color='red', max.overlaps = 1000) +
geom_point(data=most_important_without_red, aes(x = DRUG, y = scaled_LRP),color='black', size=0.2) +
geom_point(data=most_important_only_red, aes(x = DRUG, y = scaled_LRP),color='red') +
#geom_line(aes(x = DRUG, y = rankl, group = molecular_names), linewidth=0.1) +
theme_minimal() +
scale_y_continuous(trans='log10') +
theme(axis.text = element_text(size=15),
axis.title.x = element_blank(),
axis.title.y = element_text(size=20)) +
ylab('xAI-assigned Importance')
most_important_genes_plot_rank
png('./figures/important_genes_scaled.png', width=3000, height=3000, res=150)
plot_grid(relevantometer, NULL, most_important_genes_plot_rank, labels =c('A', '', 'B'), ncol=1, rel_heights = c(3,0.5, 8), label_size = 20)
dev.off()
most_important_genes_plot_rank <- ggplot(most_important, aes(x = DRUG, y = scaled_LRP, label = molecular_names)) +
geom_text_repel(data = most_important_without_red, show.legend=F, size=4, color='black', max.overlaps=100) +
geom_text_repel(data = most_important_only_red, show.legend=F, size=4, color='red', max.overlaps = 1000) +
geom_point(data=most_important_without_red, aes(x = DRUG, y = scaled_LRP),color='black', size=0.2) +
geom_point(data=most_important_only_red, aes(x = DRUG, y = scaled_LRP),color='red') +
#geom_line(aes(x = DRUG, y = rankl, group = molecular_names), linewidth=0.1) +
theme_minimal() +
scale_y_continuous(trans='log10') +
theme(axis.text = element_text(size=15),
axis.title.x = element_blank(),
axis.title.y = element_text(size=20)) +
ylab('xAI-assigned Importance') +
coord_flip()
most_important_genes_plot_rank
png('./figures/important_genes_scaled.png', width=3000, height=3000, res=150)
plot_grid(relevantometer, NULL, most_important_genes_plot_rank, labels =c('A', '', 'B'), ncol=1, rel_heights = c(3,0.5, 8), label_size = 20)
dev.off()
most_important_genes_plot_rank <- ggplot(most_important, aes(x = DRUG, y = scaled_LRP, label = molecular_names)) +
geom_text_repel(data = most_important_without_red, show.legend=F, size=4, color='black', max.overlaps=100) +
geom_text_repel(data = most_important_only_red, show.legend=F, size=4, color='red', max.overlaps = 1000) +
geom_point(data=most_important_without_red, aes(x = DRUG, y = scaled_LRP),color='black', size=0.2) +
geom_point(data=most_important_only_red, aes(x = DRUG, y = scaled_LRP),color='red') +
#geom_line(aes(x = DRUG, y = rankl, group = molecular_names), linewidth=0.1) +
theme_minimal() +
scale_y_continuous(trans='log10') +
theme(axis.text = element_text(size=15),
axis.title.x = element_blank(),
axis.title.y = element_text(size=20)) +
ylab('xAI-assigned Importance') +
scale_x_discrete(limits=rev) +
coord_flip()
most_important_genes_plot_rank
png('./figures/important_genes_scaled.png', width=3000, height=3000, res=150)
plot_grid(relevantometer, NULL, most_important_genes_plot_rank, labels =c('A', '', 'B'), ncol=1, rel_heights = c(3,0.5, 8), label_size = 20)
dev.off()
most_important_genes_plot_rank <- ggplot(most_important, aes(x = DRUG, y = scaled_LRP, label = molecular_names)) +
geom_text_repel(data = most_important_without_red, show.legend=F, size=4, color='black', max.overlaps=100) +
geom_text_repel(data = most_important_only_red, show.legend=F, size=4, color='red', max.overlaps = 1000) +
geom_point(data=most_important_without_red, aes(x = DRUG, y = scaled_LRP),color='black', size=0.2) +
geom_point(data=most_important_only_red, aes(x = DRUG, y = scaled_LRP),color='red') +
#geom_line(aes(x = DRUG, y = rankl, group = molecular_names), linewidth=0.1) +
theme_minimal() +
scale_y_continuous(trans='log10') +
theme(axis.text = element_text(size=15),
axis.title.x = element_blank(),
axis.title.y = element_text(size=20)) +
ylab('xAI-assigned Importance') +
scale_y_discrete(limits=rev) +
coord_flip()
most_important_genes_plot_rank
png('./figures/important_genes_scaled.png', width=3000, height=3000, res=150)
plot_grid(relevantometer, NULL, most_important_genes_plot_rank, labels =c('A', '', 'B'), ncol=1, rel_heights = c(3,0.5, 8), label_size = 20)
dev.off()
most_important_genes_plot_rank <- ggplot(most_important, aes(x = DRUG, y = scaled_LRP, label = molecular_names)) +
geom_text_repel(data = most_important_without_red, show.legend=F, size=4, color='black', max.overlaps=100) +
geom_text_repel(data = most_important_only_red, show.legend=F, size=4, color='red', max.overlaps = 1000) +
geom_point(data=most_important_without_red, aes(x = DRUG, y = scaled_LRP),color='black', size=0.2) +
geom_point(data=most_important_only_red, aes(x = DRUG, y = scaled_LRP),color='red') +
#geom_line(aes(x = DRUG, y = rankl, group = molecular_names), linewidth=0.1) +
theme_minimal() +
scale_y_continuous(trans='log10') +
theme(axis.text = element_text(size=15),
axis.title.x = element_blank(),
axis.title.y = element_text(size=20)) +
ylab('xAI-assigned Importance') +
coord_flip()+
scale_y_discrete(limits=rev)
most_important_genes_plot_rank
most_important_genes_plot_rank <- ggplot(most_important, aes(x = DRUG, y = scaled_LRP, label = molecular_names)) +
geom_text_repel(data = most_important_without_red, show.legend=F, size=4, color='black', max.overlaps=100) +
geom_text_repel(data = most_important_only_red, show.legend=F, size=4, color='red', max.overlaps = 1000) +
geom_point(data=most_important_without_red, aes(x = DRUG, y = scaled_LRP),color='black', size=0.2) +
geom_point(data=most_important_only_red, aes(x = DRUG, y = scaled_LRP),color='red') +
#geom_line(aes(x = DRUG, y = rankl, group = molecular_names), linewidth=0.1) +
theme_minimal() +
scale_y_continuous(trans='log10') +
theme(axis.text = element_text(size=15),
axis.title.x = element_blank(),
axis.title.y = element_text(size=20)) +
ylab('xAI-assigned Importance') +
coord_flip()+
scale_x_discrete(limits=rev)
most_important_genes_plot_rank
png('./figures/important_genes_scaled.png', width=3000, height=3000, res=150)
plot_grid(relevantometer, NULL, most_important_genes_plot_rank, labels =c('A', '', 'B'), ncol=1, rel_heights = c(3,0.5, 8), label_size = 20)
dev.off()
most_important_genes_plot_rank <- ggplot(most_important, aes(x = DRUG, y = scaled_LRP, label = molecular_names)) +
geom_line(data = line_data, aes(y = DRUG, x= x, color=moa), linewidth=1) +
geom_text_repel(data = most_important_without_red, show.legend=F, size=4, color='black', max.overlaps=100) +
geom_text_repel(data = most_important_only_red, show.legend=F, size=4, color='red', max.overlaps = 1000) +
geom_point(data=most_important_without_red, aes(x = DRUG, y = scaled_LRP),color='black', size=0.2) +
geom_point(data=most_important_only_red, aes(x = DRUG, y = scaled_LRP),color='red') +
#geom_line(aes(x = DRUG, y = rankl, group = molecular_names), linewidth=0.1) +
theme_minimal() +
scale_y_continuous(trans='log10') +
theme(axis.text = element_text(size=15),
axis.title.x = element_blank(),
axis.title.y = element_text(size=20)) +
ylab('xAI-assigned Importance') +
coord_flip() +
scale_x_discrete(limits=rev)
most_important_genes_plot_rank
most_important_genes_plot_rank <- ggplot(most_important, aes(x = DRUG, y = scaled_LRP, label = molecular_names)) +
geom_line(data = line_data, aes(x = DRUG, y= x, color=moa), linewidth=1) +
geom_text_repel(data = most_important_without_red, show.legend=F, size=4, color='black', max.overlaps=100) +
geom_text_repel(data = most_important_only_red, show.legend=F, size=4, color='red', max.overlaps = 1000) +
geom_point(data=most_important_without_red, aes(x = DRUG, y = scaled_LRP),color='black', size=0.2) +
geom_point(data=most_important_only_red, aes(x = DRUG, y = scaled_LRP),color='red') +
#geom_line(aes(x = DRUG, y = rankl, group = molecular_names), linewidth=0.1) +
theme_minimal() +
scale_y_continuous(trans='log10') +
theme(axis.text = element_text(size=15),
axis.title.x = element_blank(),
axis.title.y = element_text(size=20)) +
ylab('xAI-assigned Importance') +
coord_flip() +
scale_x_discrete(limits=rev)
most_important_genes_plot_rank
png('./figures/important_genes_scaled.png', width=3000, height=3000, res=150)
plot_grid(relevantometer, NULL, most_important_genes_plot_rank, labels =c('A', '', 'B'), ncol=1, rel_heights = c(3,0.5, 8), label_size = 20)
dev.off()
most_important_genes_plot_rank
png('./figures/important_genes.png', width=2500, height=1500, res=250)
relevantometer
dev.off()
png('./figures/important_genes.png', width=2500, height=1000, res=200)
relevantometer
dev.off()
png('./figures/important_genes.png', width=2500, height=1000, res=200)
relevantometer
dev.off()
png('./figures/important_genes.png', width=3000, height=1500, res=200)
relevantometer
dev.off()
png('./figures/important_genes.png', width=3000, height=1500, res=150)
relevantometer
dev.off()
relevantometer <- ggplot(relevantometer_data, aes(y = DRUG, x = pos, label = molecular_names)) +
geom_line(data = line_data, aes(y = DRUG, x= x, color=moa), linewidth=1) +
#geom_point(aes(color=molecular_names), size=3)+
geom_point(data = high_relevantometer_data, size=3, alpha = 1.0) +
geom_point(data = low_relevantometer_data, size=3) +
geom_text_repel(data = high_relevantometer_data, aes(y = DRUG, x = pos, label = molecular_names),direction = 'y', color = 'black') +
geom_text_repel(data = low_relevantometer_data, aes(y = DRUG, x = pos, label = molecular_names),direction = 'y', color = 'black') +
theme_minimal() +
theme(#panel.grid.major.y = element_blank(),
panel.grid.minor = element_blank(),
axis.title = element_blank(),
axis.text.y = element_text(size=15),
axis.text.x = element_text(size=15),
legend.title = element_blank(),
legend.text = element_text(size=15)) +
#ylab('Low importance rank     \U2194     High importance rank')  +
scale_y_discrete(limits=rev) +
scale_x_continuous(labels=scales::percent, limits=c(0.0,1.0)) +
coord_cartesian(xlim =c(0.0,1.0))
relevantometer
get_nth <- function(x, n=NULL) {
x <- x[order(x, decreasing=T)]
return(x[n])
}
most_important <- across_cell_lines %>%
group_by(DRUG) %>%
dplyr::mutate(cutoff = get_nth(meanabsLRP,30), scaled_LRP = meanabsLRP/max(meanabsLRP)) %>%
filter(meanabsLRP>=cutoff) %>%
mutate(rel = molecular_names %in% sel_genes) %>%
mutate(DRUG = factor(DRUG, levels = order_by_moa$DRUG))
most_important_only_red <- most_important %>%
filter(molecular_names %in% sel_genes)
most_important_without_red <- most_important %>%
filter(!(molecular_names %in% sel_genes))
most_important_genes_plot_rank <- ggplot(most_important, aes(x = DRUG, y = scaled_LRP, label = molecular_names)) +
geom_line(data = line_data, aes(x = DRUG, y= x, color=moa), linewidth=1) +
geom_text_repel(data = most_important_without_red, show.legend=F, size=4, color='black', max.overlaps=100) +
geom_text_repel(data = most_important_only_red, show.legend=F, size=4, color='red', max.overlaps = 1000) +
geom_point(data=most_important_without_red, aes(x = DRUG, y = scaled_LRP),color='black', size=0.2) +
geom_point(data=most_important_only_red, aes(x = DRUG, y = scaled_LRP),color='red') +
#geom_line(aes(x = DRUG, y = rankl, group = molecular_names), linewidth=0.1) +
theme_minimal() +
scale_y_continuous(trans='log10') +
theme(axis.text = element_text(size=15),
axis.title.x = element_blank(),
axis.title.y = element_text(size=20)) +
ylab('xAI-assigned Importance') +
coord_flip() +
scale_x_discrete(limits=rev)
most_important_genes_plot_rank
png('./figures/important_genes.png', width=3000, height=1500, res=150)
relevantometer
dev.off()
png('./figures/important_genes.png', width=3000, height=1500, res=200)
relevantometer
dev.off()
png('./figures/important_genes_scaled.png', width=3000, height=3000, res=150)
plot_grid(relevantometer, NULL, most_important_genes_plot_rank, labels =c('A', '', 'B'), ncol=1, rel_heights = c(3,0.5, 8), label_size = 20)
dev.off()
png('./figures/important_genes_scaled.png', width=3000, height=3000, res=150)
most_important_genes
dev.off()
png('./figures/important_genes_scaled.png', width=3000, height=3000, res=150)
most_important_genes
dev.off()
png('./figures/important_genes_scaled.png', width=3000, height=3000, res=150)
most_important_genes_plot_rank
dev.off()
png('./figures/important_genes_scaled.png', width=3000, height=2000, res=150)
most_important_genes_plot_rank
dev.off()
png('./figures/important_genes_scaled.png', width=3000, height=2000, res=200)
most_important_genes_plot_rank
dev.off()
most_important_genes_plot_rank <- ggplot(most_important, aes(x = DRUG, y = scaled_LRP, label = molecular_names)) +
geom_line(data = line_data, aes(x = DRUG, y= x, color=moa), linewidth=1) +
geom_text_repel(data = most_important_without_red, show.legend=F, size=4, color='black', max.overlaps=100) +
geom_text_repel(data = most_important_only_red, show.legend=F, size=4, color='red', max.overlaps = 1000) +
geom_point(data=most_important_without_red, aes(x = DRUG, y = scaled_LRP),color='black', size=0.2) +
geom_point(data=most_important_only_red, aes(x = DRUG, y = scaled_LRP),color='red') +
theme_minimal() +
scale_y_continuous(trans='log10') +
theme(axis.text = element_text(size=15),
axis.title.x = element_blank(),
axis.title.y = element_text(size=20),
legend.title = element_blank(),
legend.text = element_text(size=15)) +
ylab('xAI-assigned Importance') +
coord_flip() +
scale_x_discrete(limits=rev)
most_important_genes_plot_rank
png('./figures/important_genes.png', width=3000, height=1500, res=200)
relevantometer
dev.off()
png('./figures/important_genes_scaled.png', width=3000, height=2000, res=150)
most_important_genes_plot_rank
dev.off()
most_important_genes_plot_rank <- ggplot(most_important, aes(x = DRUG, y = scaled_LRP, label = molecular_names)) +
geom_line(data = line_data, aes(x = DRUG, y= x, color=moa), linewidth=1) +
geom_text_repel(data = most_important_without_red, show.legend=F, size=4, color='black', max.overlaps=100) +
geom_text_repel(data = most_important_only_red, show.legend=F, size=4, color='red', max.overlaps = 1000) +
geom_point(data=most_important_without_red, aes(x = DRUG, y = scaled_LRP),color='black', size=0.2) +
geom_point(data=most_important_only_red, aes(x = DRUG, y = scaled_LRP),color='red') +
theme_minimal() +
scale_y_continuous(trans='log10') +
theme(axis.text = element_text(size=15),
axis.title.x = element_blank(),
axis.title.y = element_text(size=20),
legend.title = element_blank(),
legend.text = element_text(size=15),
legend.position = 'bottom') +
ylab('xAI-assigned Importance') +
coord_flip() +
scale_x_discrete(limits=rev)
png('./figures/important_genes_scaled.png', width=3000, height=2000, res=150)
most_important_genes_plot_rank
dev.off()
most_important_genes_plot_rank <- ggplot(most_important, aes(x = DRUG, y = scaled_LRP, label = molecular_names)) +
geom_line(data = line_data, aes(x = DRUG, y= x, color=moa), linewidth=1) +
geom_text_repel(data = most_important_without_red, show.legend=F, size=4, color='black', max.overlaps=100) +
geom_text_repel(data = most_important_only_red, show.legend=F, size=4, color='red', max.overlaps = 1000) +
geom_point(data=most_important_without_red, aes(x = DRUG, y = scaled_LRP),color='black', size=0.2) +
geom_point(data=most_important_only_red, aes(x = DRUG, y = scaled_LRP),color='red') +
theme_minimal() +
scale_y_continuous(trans='log10') +
theme(axis.text = element_text(size=15),
axis.title.y = element_blank(),
axis.title.x = element_text(size=20),
legend.title = element_blank(),
legend.text = element_text(size=15),
legend.position = 'bottom') +
ylab('xAI-assigned Importance') +
coord_flip() +
scale_x_discrete(limits=rev)
png('./figures/important_genes_scaled.png', width=3000, height=2000, res=150)
most_important_genes_plot_rank
dev.off()
png('./figures/important_genes_scaled.png', width=3000, height=2000, res=150)
most_important_genes_plot_rank
dev.off()
most_important_genes_plot_rank <- ggplot(most_important, aes(x = DRUG, y = scaled_LRP, label = molecular_names)) +
geom_line(data = line_data, aes(x = DRUG, y= x, color=moa), linewidth=1) +
geom_text_repel(data = most_important_without_red, show.legend=F, size=4, color='black', max.overlaps=100) +
geom_text_repel(data = most_important_only_red, show.legend=F, size=4, color='red', max.overlaps = 1000) +
geom_point(data=most_important_without_red, aes(x = DRUG, y = scaled_LRP),color='black', size=0.2) +
geom_point(data=most_important_only_red, aes(x = DRUG, y = scaled_LRP),color='red') +
theme_minimal() +
scale_y_continuous(trans='log10') +
theme(axis.text = element_text(size=15),
axis.title.y = element_blank(),
axis.title.x = element_text(size=20),
legend.title = element_blank(),
legend.text = element_text(size=15),
legend.position = 'bottom') +
ylab('xAI-assigned Importance') +
coord_flip() +
scale_x_discrete(limits=rev)
png('./figures/important_genes_scaled.png', width=3000, height=2000, res=150)
most_important_genes_plot_rank
dev.off()
most_important_genes_plot_rank <- ggplot(most_important, aes(x = DRUG, y = scaled_LRP, label = molecular_names)) +
geom_line(data = line_data, aes(x = DRUG, y= x, color=moa), linewidth=1) +
geom_text_repel(data = most_important_without_red, show.legend=F, size=4, color='black', max.overlaps=100) +
geom_text_repel(data = most_important_only_red, show.legend=F, size=4, color='red', max.overlaps = 1000) +
geom_point(data=most_important_without_red, aes(x = DRUG, y = scaled_LRP),color='black', size=0.2) +
geom_point(data=most_important_only_red, aes(x = DRUG, y = scaled_LRP),color='red') +
theme_minimal() +
#scale_y_continuous(trans='log10') +
theme(axis.text = element_text(size=15),
axis.title.y = element_blank(),
axis.title.x = element_text(size=20),
legend.title = element_blank(),
legend.text = element_text(size=15),
legend.position = 'bottom') +
ylab('xAI-assigned Importance') +
coord_flip() +
scale_x_discrete(limits=rev)
png('./figures/important_genes_scaled.png', width=3000, height=2000, res=150)
most_important_genes_plot_rank
dev.off()
png('./figures/important_genes_scaled.png', width=3000, height=2200, res=150)
most_important_genes_plot_rank
dev.off()
most_important_genes_plot_rank <- ggplot(most_important, aes(x = DRUG, y = scaled_LRP, label = molecular_names)) +
geom_line(data = line_data, aes(x = DRUG, y= x, color=moa), linewidth=1) +
geom_text_repel(data = most_important_without_red, show.legend=F, size=4, color='black', max.overlaps=100) +
geom_text_repel(data = most_important_only_red, show.legend=F, size=4, color='red', max.overlaps = 1000) +
geom_point(data=most_important_without_red, aes(x = DRUG, y = scaled_LRP),color='black', size=0.2) +
geom_point(data=most_important_only_red, aes(x = DRUG, y = scaled_LRP),color='red') +
theme_minimal() +
scale_y_continuous(trans='log10') +
theme(axis.text = element_text(size=15),
axis.title.y = element_blank(),
axis.title.x = element_text(size=20),
legend.title = element_blank(),
legend.text = element_text(size=15),
legend.position = 'bottom') +
ylab('xAI-assigned Importance') +
coord_flip() +
scale_x_discrete(limits=rev)
png('./figures/important_genes_scaled.png', width=3000, height=2200, res=150)
most_important_genes_plot_rank
dev.off()
relevantometer <- ggplot(relevantometer_data, aes(y = DRUG, x = pos, label = molecular_names)) +
geom_line(data = line_data, aes(y = DRUG, x= x, color=moa), linewidth=1) +
#geom_point(aes(color=molecular_names), size=3)+
geom_point(data = high_relevantometer_data, size=3, alpha = 1.0) +
geom_point(data = low_relevantometer_data, size=3) +
geom_text_repel(data = high_relevantometer_data, aes(y = DRUG, x = pos, label = molecular_names),direction = 'y', color = 'black') +
geom_text_repel(data = low_relevantometer_data, aes(y = DRUG, x = pos, label = molecular_names),direction = 'y', color = 'black') +
theme_minimal() +
theme(#panel.grid.major.y = element_blank(),
panel.grid.minor = element_blank(),
axis.title = element_blank(),
axis.text.y = element_text(size=15),
axis.text.x = element_text(size=15),
legend.title = element_blank(),
legend.text = element_text(size=15),
legend.position = 'bottom') +
#ylab('Low importance rank     \U2194     High importance rank')  +
scale_y_discrete(limits=rev) +
scale_x_continuous(labels=scales::percent, limits=c(0.0,1.0)) +
coord_cartesian(xlim =c(0.0,1.0))
most_important_genes_plot_rank
png('./figures/important_genes.png', width=3000, height=1500, res=200)
relevantometer
dev.off()
